# ASHVAC – Rule 4-3

**Rule ID:** 4-3
 
**Rule Description:** HVAC Fan Schedules. Schedules for HVAC fans that provide outdoor air for ventilation shall run continuously whenever spaces are occupied.  
**Rule Assertion:** P-RMR = expected value                                           
**Appendix G Section:** Section G3.1-4 Schedules for the proposed building excluding exception #1. 
**Appendix G Section Reference:**  

**Applicability:** All required data elements exist for P_RMR  
**Applicability Checks:** 

1. Not applicable for when the heating_ventilation_air_conditioning_systems is being simulated only to meet the requirements described in Table G3.1.
2. PLACEHOLDER: Needs to have passed check that the project correctly complies with Table G3.1 #10 proposed c and d.

**Manual Check:** None  
**Evaluation Context:** Evaluate each data element  
**Data Lookup:** None  
**Function Call:** None

## Rule Logic:
- For each zone in U_RMR: `for zone_u in U_RMR...zones:`
    - Reset heating system exists boolean variable equal to false each time it loops to a different zone: `heating_system_exists_u = FALSE`
    - Reset cooling system exists boolean variable equal to false each time it loops to a different zone: `cooling_system_exists_u = FALSE`
    - Reset heating system exists boolean variable equal to false each time it loops to a different zone: `heating_system_exists_p = FALSE`
    - Reset cooling system exists boolean variable equal to false each time it loops to a different zone: `cooling_system_exists_p = FALSE`
    - Check if there are terminal units associated with the zone, if not skip to proposed: `if len(zone_u.terminals) != 0:`
        - For each terminal unit associated with each zone: `for terminal_u in zone_u:`
            - if reheat_source is not null then set heating exists boolean variable equal to true: `if terminal_u.reheat_source != "None":`
                - Set heating system exists boolean variable equal to true: `heating_system_exists_u = TRUE`
            - if heat_capacity is not zero then set heating exists boolean variable equal to true: `if terminal_u.heat_capacity != 0:`
                - Set heating system exists boolean variable equal to true: `heating_system_exists_u = TRUE`    
            - Get the served_by_heating_ventilation_air_conditioning_systems for each terminal: `heating_ventilation_air_conditioning_systems_u = terminal_u.served_by_heating_ventilation_air_conditioning_systems`
                - Create list of heating_ventilation_air_conditioning_systems_u add to as the code loops through the terminal units: `heating_ventilation_air_conditioning_systems_list_u = heating_ventilation_air_conditioning_systems_list_u.append(heating_ventilation_air_conditioning_systems_u)`                    
        - Convert the list of heating_ventilation_air_conditioning_systems_list_u associated with the zone to a set and the back to a list to eliminate duplicates: `heating_ventilation_air_conditioning_systems_list_u = list(set(heating_ventilation_air_conditioning_systems_list_u))`
        - For each hvac_u in heating_ventilation_air_conditioning_systems_list_u: `for hvac_u in heating_ventilation_air_conditioning_systems_list_u:`
            - For each heating system in hvac_u: `for heating_system_u in hvac_u.heating_system:`
                - if heating_system_type is not "None": `if heating_system_u.heating_system_type != "None":`
                    - Set heating system exists boolean variable equal to true: `heating_system_exists_u = TRUE`
            - For each cooling system in hvac_u: `for cooling_system_u in hvac_u.cooling_system:`
                - if cooling_system_type is not "None": `if cooling_system_u.cooling_system_type != "None":`
                    - Set cooling system exists boolean variable equal to true: `cooling_system_exists_u = TRUE`
            - For each preheat system in hvac_u: `for preheat_system_u in hvac_u.preheat_system:`
                - if preheat_system_type is not "None": `if preheat_system_u.heating_system_type != "None":`
                    - Set heating system exists boolean variable equal to true: `heating_system_exists_u = TRUE`

    - Get the analogous Zone ID in the P_RMR: `zone_p = match_data_element(P_RMR,Zones,zone_u.id)`
    - Check if there are terminal units associated with the zone, if not skip to if statements based on if there are heating and cooling systems: `if len(zone_p.terminals) != 0:`
        - For each terminal unit associated with each zone: `for terminal_p in zone_p:`
            - if reheat_source is not null then set heating exists boolean variable equal to true: `if terminal_p.reheat_source != "None":`
                - Set heating system exists boolean variable equal to true: `heating_system_exists_p = TRUE`
            - if heat_capacity is not zero then set heating exists boolean variable equal to true: `if terminal_p.heat_capacity != 0:`
                - Set heating system exists boolean variable equal to true: `heating_system_exists_p = TRUE`    
            - Get the served_by_heating_ventilation_air_conditioning_systems for each terminal: `heating_ventilation_air_conditioning_systems_p = terminal_p.served_by_heating_ventilation_air_conditioning_systems`
                - Create list of heating_ventilation_air_conditioning_systems_p add to as the code loops through the terminal units: `heating_ventilation_air_conditioning_systems_list_p = heating_ventilation_air_conditioning_systems_list_p.append(heating_ventilation_air_conditioning_systems_p)`                    
        - Convert the list of heating_ventilation_air_conditioning_systems_list_p associated with the zone to a set and the back to a list to eliminate duplicates: `heating_ventilation_air_conditioning_systems_list_p = list(set(heating_ventilation_air_conditioning_systems_list_p))`
            - For each hvac_p in heating_ventilation_air_conditioning_systems_list_p: `for hvac_p in heating_ventilation_air_conditioning_systems_list_p:`
                - For each heating system in hvac_p: `for heating_system_p in hvac_p.heating_system:`
                    - if heating_system_type is not "None": `if heating_system_p.heating_system_type != "None":`
                        - Set heating system exists boolean variable equal to true: `heating_system_exists_p = TRUE`
                - For each cooling system in hvac_p: `for cooling_system_p in hvac_p.cooling_system:`
                    - if cooling_system_type is not "None": `if cooling_system_p.cooling_system_type != "None":`
                        - Set cooling system exists boolean variable equal to true: `cooling_system_exists_p = TRUE`
                - For each preheat system in hvac_u: `for preheat_system_p in hvac_p.preheat_system:`
                    - if preheat_system_type is not "None": `if preheat_system_p.heating_system_type != "None":`
                        - Set heating system exists boolean variable equal to true: `heating_system_exists_p = TRUE`   
        
        
    - if zone has heating and cooling in the U_RMR: `if heating_system_exists_u == TRUE AND cooling_system_exists_u == TRUE:`
        - Set applicability flag: `rule_applicability_check = TRUE`
            - else if the zone has heating but no cooling in the U_RMR and P_RMR: `else if heating_system_exists_u == TRUE AND cooling_system_exists_u == FALSE AND heating_system_exists_p == TRUE AND cooling_system_exists_p == FALSE:`
                - Set applicability flag: `rule_applicability_check = TRUE`                
                    - if rule_applicability_check = TRUE: `if rule_applicability_check == TRUE:`
                        - For each hvac_u in heating_ventilation_air_conditioning_systems_list_u: `for hvac_u in heating_ventilation_air_conditioning_systems_list_u:`
                            - Get the analogous HVAC ID in the P_RMR: `hvac_p = match_data_element(P_RMR,heating_ventilation_air_conditioning_systems,hvac_u.id)`
                                - Add to list of HVAC system that are applicable to this check: `applicable_hvac_systems_list_p = applicable_hvac_systems_list_p.append(hvac_p)`

 - Convert the list of applicable_hvac_systems_list_p to a set and the back to a list to eliminate duplicates after looping through all zones: 
 `applicable_hvac_systems_list_p = list(set(applicable_hvac_systems_list_p))`           
- For each hvac_p in applicable_hvac_systems_list_p: `for each hvac_p in applicable_hvac_systems_list_p:`                                    
    - For each fan system in hvac_p: `fan_systems_p in hvac_p.fan_systems:`
        - Get operation during occupied periods: `operation_during_occupied_p = fans_systems_p.operation_during_occupied`

        **Rule Assertion:**
        - Case 1: if fan system operation during occupied periods is continuous in the P_RMR: `if operation_during_occupied_p == “CONTINUOUS”: PASS`

        - Case 2: Else: `Else: FAIL and raise_warning “FAN SYSTEM PROPOSED DESIGN MODEL OCCUPIED CONTROL IS NOT MODELED AS CONTINUOUS PER G3.1-4.”`

**Applicability Checks:** 

 1. Not applicable for when the heating_ventilation_air_conditioning_systems is being simulated only to meet the requirements described in Table G3.1: `if rule_applicability_check: is_applicable = TRUE`
 2. PLACEHOLDER: Needs to have passed check that the project correctly complies with Table G3.1 #10 proposed c and d.