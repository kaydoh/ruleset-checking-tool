# ASHVAC – Rule 4-6

**Rule ID:** 4-6
 
**Rule Description:** HVAC fans shall remain on during unoccupied hours in systems primarily serving computer rooms.  
**Rule Assertion:** P-RMR = expected value                                           
**Appendix G Section:** Section G3.1-4 exception #3 Schedules for the proposed building  
**Appendix G Section Reference:**  

**Applicability:** All required data elements exist for P_RMR  
**Applicability Checks:** 

 1. P-RMR is modeled with computer room spaces: `if len(applicable_hvac_systems_list_p) > 0`

**Manual Check:** None  
**Evaluation Context:** Evaluate each data element  
**Data Lookup:** None  
**Function Call:** None

## Rule Logic:
- For each zone in P_RMR: `for zone_p in P_RMR...zones:`
    - Reset applicabliity flag: `rule_applicability_check: is_applicable = FALSE`
    - For each space in the zone: `for space_p in zone_p.zones:`
        - Check if space(s) is of type computer room: `if space_p.lighting_space_type in [COMPUTER_ROOM]:`
            - Set applicability flag to TRUE if any spaces are computer room: `rule_applicability_check = TRUE`
    - Check if the applicability flag equals TRUE: `if rule_applicability_check == TRUE:`
    - For each terminal in zone_p: `for terminal_p in zone_p.terminals:`
        - Get HVAC system serving terminal: `hvac_p = terminal_p.served_by_heating_ventilation_air_conditioning_systems`
            - Add to list of heating_ventilation_air_conditioning_systems_p as the code loops through the terminal units: `heating_ventilation_air_conditioning_systems_list_p = heating_ventilation_air_conditioning_systems_list_p.append(heating_ventilation_air_conditioning_systems_p)`                    
    - Add to master list of HVAC system that are applicable to this check: `applicable_hvac_systems_list_p = applicable_hvac_systems_list_p.append(heating_ventilation_air_conditioning_systems_list_p)`         
- Convert the list of applicable_hvac_systems_list_p to a set and the back to a list to eliminate duplicates after looping through all zones: 
 `applicable_hvac_systems_list_p = list(set(applicable_hvac_systems_list_p))`                             
  - For each hvac_p in applicable_hvac_systems_list_p: `for each hvac_p in applicable_hvac_systems_list_p:`                         
    - For each fan system in hvac_p: `fan_systems_p in hvac_p.fan_systems:`
        - Get operation during unoccupied periods: `operation_during_unoccupied_p = fans_systems_p.operation_during_unoccupied`

        **Rule Assertion - Component:**
        - Case 1: For each applicable fan system, if fan system operation during unoccupied periods is continuous in the P_RMR: `if operation_during_unoccupied_p == “CONTINUOUS”: PASS`

        - Case 2: Else, for each applicable fan system, save hvac id to output array for failed components:`Else: FAIL and failed_component_array.append(hvac_p)`

**Rule Assertion - RMR:**

- Case 1: If all components pass in the P-RMR: `if ALL_COMPONENTS == PASS: PASS`

- Case 2 : Else if the applicability check equals FALSE: `else if len(applicable_hvac_systems_list_p) ==0: NOT APPLICABLE`

- Case 3: Else, list all failed components: `else: FAIL and raise_message ${failed_component_array}`          
        

**Applicability Checks:** 

 1. P-RMR is modeled with computer room spaces: `if len(applicable_hvac_systems_list_p) > 0`